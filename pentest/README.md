# Non-auth Dart Example App

This is a sample amplify-flutter application for testing. It includes two environments for testing various code paths:

## Getting the code

1. clone this repo with `git clone git@github.com:aws-amplify/amplify-flutter.git`
2. cd into repo `cd amplify-flutter`
3. get to the correct branch `git checkout non_auth_pentest`
3. navigate to app `cd pentest`
4. ask service team for amplifyconfiguration via slack. Create a file in the pentest directory at `lib/amplifyconfiguration.dart` (repo path would be `pentest/lib/amplifyconfiguration.dart`) with the contents of that file.

## Installing Dart dependencies

From the root of the pentest directory, run `flutter pub get`.

## Installing Linux dependencies

All platform specific dependencies are downloaded for you, with the exception of 2 linux packages. These can be installed with:

```terminal
sudo apt-get update -y
sudo apt-get install -y libsecret-1-dev
sudo apt-get install -y libglib2.0-dev
```

## Enabling MacOS Support

If you try to run on MacoOS without following the steps below, it is likely you will receive a message to this affect:

To enable MacOS, complete the following:

1. Enable network calls
    * In Xcode, enable the Client networking entitlement and add the Keychain Sharing entitlement as shown

2. Add your app to a Keychain Access Group. 

Amplify Auth stores auth credentials in Keychain on MacOS. The keychain option kSecUseDataProtectionKeychain (https://developer.apple.com/documentation/security/ksecusedataprotectionkeychain?language=objc) is enabled by default, which makes it so that only your app has access to these credentials. This requires that your app be in at least one Keychain Access Group. Below are the steps to add your app to the default group, using your appâ€™s bundle identifier.

    * Open the MacOS project in Xcode (from VS Code, right click on the /macos dir and select "Open in Xcode")
    * Select "Runner" on the left side panel, then select the "Signing & Capabilities" tab, and tap the "+" icon.
    * Search for "Keychain Sharing" and add the "Keychain Sharing" capability.
    * Scroll down to Keychain Sharing and click the "+" icon. By default, your bundle ID will be used.


3. If you have not yet already - add a development team and enable signing (this may require an AppleID to access to a development team).


## Enabling Windows support

Some of our packages have filepaths that violate some Windows path character limits. In order to correct this, you may need:

- Change the Windows [file path restriction](https://www.howtogeek.com/266621/how-to-make-windows-10-accept-file-paths-over-260-characters/)
- Remove restrictions via git config (you may need to run a prompt as administrator):

```terminal
git config --system.core.longpaths true
```
