// ignore_for_file: invalid_use_of_protected_member

import 'package:amplify_auth_cognito/amplify_auth_cognito.dart';
import 'package:amplify_flutter/amplify_flutter.dart';
import 'package:flutter/material.dart';
import 'package:pentest_soundboard/json.dart';

import 'common.dart';

const usernameField = SoundboardTextField(
  labelText: 'Username',
  jsonPath: JsonPath([
    JsonPathItem<String, String>('username'),
  ]),
  required: true,
);

const passwordField = SoundboardTextField(
  labelText: 'Password',
  jsonPath: JsonPath([
    JsonPathItem<String, String>('password'),
  ]),
  required: false,
);

const newPasswordField = SoundboardTextField(
  labelText: 'New Password',
  jsonPath: JsonPath([
    JsonPathItem<String, String>('newPassword'),
  ]),
  required: true,
);

const confirmationCodeField = SoundboardTextField(
  labelText: 'Confirmation Code',
  jsonPath: JsonPath([
    JsonPathItem<String, String>('confirmationCode'),
  ]),
  required: true,
);

const confirmationValueField = SoundboardTextField(
  labelText: 'Confirmation Value',
  jsonPath: JsonPath([
    JsonPathItem<String, String>('confirmationValue'),
  ]),
  required: true,
);

const userAttributesField = SoundboardMapField(
  labelText: 'User Attribute',
  jsonPath: JsonPath([
    JsonPathItem<String, Map<String, Object?>>('options'),
    JsonPathItem<String, Object?>('userAttributes'),
  ]),
  values: CognitoUserAttributeKey.values,
);

const clientMetadataField = SoundboardMapField<String>(
  labelText: 'Client Metadata',
  jsonPath: JsonPath([
    JsonPathItem<String, Map<String, Object?>>('options'),
    JsonPathItem<String, Object?>('clientMetadata'),
  ]),
);

final List<Widget> buttons = [
  SoundboardButton(
    methodName: 'Amplify.Auth.signUp',
    method: Amplify.Auth.defaultPlugin.signUp,
    requestSymbol: #request,
    requestFromJson: (json) => SignUpRequest.fromJson(
      json,
      CognitoSignUpOptions.fromJson,
    ),
    formFields: const [
      usernameField,
      passwordField,
      userAttributesField,
      clientMetadataField,
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.confirmSignUp',
    method: Amplify.Auth.defaultPlugin.confirmSignUp,
    requestSymbol: #request,
    requestFromJson: (json) => ConfirmSignUpRequest.fromJson(
      json,
      CognitoConfirmSignUpOptions.fromJson,
    ),
    formFields: const [
      usernameField,
      confirmationCodeField,
      userAttributesField,
      clientMetadataField,
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.resendSignUpCode',
    method: Amplify.Auth.defaultPlugin.resendSignUpCode,
    requestSymbol: #request,
    requestFromJson: (json) => ResendSignUpCodeRequest.fromJson(
      json,
      CognitoResendSignUpCodeOptions.fromJson,
    ),
    formFields: const [
      usernameField,
      clientMetadataField,
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.signIn',
    method: Amplify.Auth.defaultPlugin.signIn,
    requestSymbol: #request,
    requestFromJson: (json) => SignInRequest.fromJson(
      json,
      CognitoSignInOptions.fromJson,
    ),
    formFields: const [
      usernameField,
      passwordField,
      SoundboardDropdown(
        labelText: 'Auth Flow Type',
        jsonPath: JsonPath([
          JsonPathItem<String, Map<String, Object?>>('options'),
          JsonPathItem<String, Object?>('authFlow'),
        ]),
        values: AuthenticationFlowType.values,
      ),
      clientMetadataField,
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.confirmSignIn',
    method: Amplify.Auth.defaultPlugin.confirmSignIn,
    requestSymbol: #request,
    requestFromJson: (json) => ConfirmSignInRequest.fromJson(
      json,
      CognitoConfirmSignInOptions.fromJson,
    ),
    formFields: const [
      confirmationValueField,
      userAttributesField,
      clientMetadataField,
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.signOut',
    method: Amplify.Auth.defaultPlugin.signOut,
    requestSymbol: #request,
    requestFromJson: SignOutRequest.fromJson,
    formFields: const [
      SoundboardToggle(
        labelText: 'Global Sign Out',
        jsonPath: JsonPath([
          JsonPathItem<String, Object?>('globalSignOut'),
        ]),
      ),
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.updatePassword',
    method: Amplify.Auth.defaultPlugin.updatePassword,
    requestSymbol: #request,
    requestFromJson: (json) => UpdatePasswordRequest.fromJson(
      json,
      CognitoUpdatePasswordOptions.fromJson,
    ),
    formFields: const [
      SoundboardTextField(
        labelText: 'Old Password',
        jsonPath: JsonPath([
          JsonPathItem<String, String>('oldPassword'),
        ]),
        required: true,
      ),
      SoundboardTextField(
        labelText: 'New Password',
        jsonPath: JsonPath([
          JsonPathItem<String, String>('newPassword'),
        ]),
        required: true,
      ),
      clientMetadataField,
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.resetPassword',
    method: Amplify.Auth.defaultPlugin.resetPassword,
    requestSymbol: #request,
    requestFromJson: (json) => ResetPasswordRequest.fromJson(
      json,
      CognitoResetPasswordOptions.fromJson,
    ),
    formFields: const [
      SoundboardTextField(
        labelText: 'Old Password',
        jsonPath: JsonPath([
          JsonPathItem<String, String>('oldPassword'),
        ]),
        required: true,
      ),
      newPasswordField,
      clientMetadataField,
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.confirmResetPassword',
    method: Amplify.Auth.defaultPlugin.confirmResetPassword,
    requestSymbol: #request,
    requestFromJson: (json) => ConfirmResetPasswordRequest.fromJson(
      json,
      CognitoConfirmResetPasswordOptions.fromJson,
    ),
    formFields: const [
      usernameField,
      newPasswordField,
      confirmationCodeField,
      clientMetadataField,
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.getCurrentUser',
    method: Amplify.Auth.defaultPlugin.getCurrentUser,
    requestSymbol: #request,
    requestFromJson: (json) => const AuthUserRequest(),
    formFields: const [],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.fetchUserAttributes',
    method: Amplify.Auth.defaultPlugin.fetchUserAttributes,
    requestSymbol: #request,
    requestFromJson: (json) => const FetchUserAttributesRequest(),
    formFields: const [],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.fetchAuthSession',
    method: Amplify.Auth.defaultPlugin.fetchAuthSession,
    requestSymbol: #request,
    requestFromJson: (json) => AuthSessionRequest.fromJson(
      json,
      CognitoSessionOptions.fromJson,
    ),
    formFields: const [
      SoundboardToggle(
        labelText: 'Get AWS Credentials',
        jsonPath: JsonPath([
          JsonPathItem<String, Map<String, Object?>>('options'),
          JsonPathItem<String, Object?>('getAwsCredentials'),
        ]),
      ),
    ],
  ),
  SoundboardButton(
    methodName: 'Amplify.Auth.signInWithWebUI',
    method: Amplify.Auth.defaultPlugin.signInWithWebUI,
    requestSymbol: #request,
    requestFromJson: (json) => SignInWithWebUIRequest.fromJson(
      json,
      CognitoSignInWithWebUIOptions.fromJson,
    ),
    formFields: const [
      SoundboardDropdown(
        labelText: 'Auth Provider',
        jsonPath: JsonPath([
          JsonPathItem<String, String>('authProvider'),
        ]),
        values: AuthProvider.values,
      ),
      SoundboardToggle(
        labelText: 'Prefer Private Session',
        jsonPath: JsonPath([
          JsonPathItem<String, Map<String, Object?>>('options'),
          JsonPathItem<String, Object?>('isPreferPrivateSession'),
        ]),
      ),
      SoundboardTextField(
        labelText: 'Browser Package',
        jsonPath: JsonPath([
          JsonPathItem<String, Map<String, Object?>>('options'),
          JsonPathItem<String, Object?>('browserPackageName'),
        ]),
        required: false,
      ),
    ],
  ),
];
